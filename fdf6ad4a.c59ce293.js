(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{88:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return b}));var r=n(3),a=n(7),i=(n(0),n(91)),l={id:"introduction",title:"DOM Store",sidebar_label:"Introduction To DOM Store",description:"DOM store traverse through the DOM tree using element-id",keywords:["algorithm","store","docs","DOM","dflex"]},o={unversionedId:"dom-store/introduction",id:"dom-store/introduction",isDocsHomePage:!1,title:"DOM Store",description:"DOM store traverse through the DOM tree using element-id",source:"@site/docs\\dom-store\\intro.md",slug:"/dom-store/introduction",permalink:"/dflex/docs/dom-store/introduction",editUrl:"https://github.com/jalal246/dflex/edit/master/docs/docs/dom-store/intro.md",version:"current",sidebar_label:"Introduction To DOM Store",sidebar:"someSidebar",previous:{title:"DOM Generator",permalink:"/dflex/docs/dom-gen/introduction"},next:{title:"Draggable",permalink:"/dflex/docs/draggable/introduction"}},c=[{value:"Installation",id:"installation",children:[]},{value:"Why",id:"why",children:[]},{value:"Features",id:"features",children:[]},{value:"Register elements in the store",id:"register-elements-in-the-store",children:[]},{value:"Getting element in the store",id:"getting-element-in-the-store",children:[{value:"Element Instance Meta by ID",id:"element-instance-meta-by-id",children:[]},{value:"Element in Tree by ID",id:"element-in-tree-by-id",children:[]}]},{value:"Why this is matter",id:"why-this-is-matter",children:[]}],s={toc:c};function b(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Traverse through the DOM tree using element-id.")),Object(i.b)("p",null,"DFlex store works on connecting all registered elements and organizes the\nrelations between them using the DOM relations generator algorithm. Allowing\neach element to be reached recursively using its id."),Object(i.b)("h2",{id:"installation"},"Installation"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"npm install @dflex/store\n")),Object(i.b)("h2",{id:"why"},"Why"),Object(i.b)("p",null,"To increase application performance if it relies heavily on the DOM nodes. To be\nclear, this is not a case against HTML DOM API. Instead, this a way to enhance\ndealing with nodes more freely when you rely on existing DOM store."),Object(i.b)("p",null,"Giving this fact, the Dflex store is built on what you already have and you can\neasily access each DOM node with ",Object(i.b)("inlineCode",{parentName:"p"},"id"),". In DFlex store ids are used as keys."),Object(i.b)("h2",{id:"features"},"Features"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Read once from the browser and avoid unnecessary painting.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"This is the only solution that allows you to get a full DOM tree.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Avoid the slowness of ",Object(i.b)("inlineCode",{parentName:"p"},"getElementById"),".")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Implement it everywhere because it is not related to any framework/library."))),Object(i.b)("h2",{id:"register-elements-in-the-store"},"Register elements in the store"),Object(i.b)("p",{align:"center"},Object(i.b)("img",{src:"https://raw.githubusercontent.com/jalal246/dflex/master/packages/store/img/store-registry.png",alt:"how register works"})),Object(i.b)("p",null,"Registry works on creating\n",Object(i.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/jalal246/dflex/tree/master/packages/dom-gen#generates-element-pointer"}),"pointer"),"\nfor element then store it with another passed data."),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"store.register(\n  elmInstance: Object<elmInstance>,\n  CustomInstance:? <Function>,\n  options:? Object\n)\n")),Object(i.b)("p",null,"Where ",Object(i.b)("inlineCode",{parentName:"p"},"elmInstance")," should include:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"id: string")," - element id."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"depth: number")," - element depth in DOM tree."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"rest: any")," - another data you want to store it for each element.")),Object(i.b)("p",null,"And ",Object(i.b)("inlineCode",{parentName:"p"},"CustomInstance")," is constructor function. In case there's an operation\ndepends on generated pointer result before storing the element."),Object(i.b)("p",null,"While ",Object(i.b)("inlineCode",{parentName:"p"},"options")," is plain objects holds extra data to be registered in the store if\nthere's any. Gives more flexibility to separate the essential data in\n",Object(i.b)("inlineCode",{parentName:"p"},"elmInstance")," from extra once that will passed in ",Object(i.b)("inlineCode",{parentName:"p"},"options"),"."),Object(i.b)("p",null,"Let's create new store and register some elements in it:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'import Store from "dflex/store";\n\nconst store = new Store();\n\nconst elm0D0 = {\n  id: "id-0",\n  depth: 0,\n  moreInfo: "I am the first child",\n};\nstore.register(elm0D0);\n\nconst elm1D0 = {\n  id: "id-1",\n  depth: 0,\n  moreInfo: "I am the second child",\n};\nstore.register(elm1D0);\n')),Object(i.b)("p",null,"To store instance of ",Object(i.b)("inlineCode",{parentName:"p"},"ExtraInstanceFunc"),", just pass it to the ",Object(i.b)("inlineCode",{parentName:"p"},"register")),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'function ExtraInstanceFunc({ id, depth, moreInfo, pointer }) {\n  this.id = id;\n  this.depth = depth;\n  this.moreInfo = moreInfo;\n  this.pointer = pointer;\n}\n\nconst elm0D1 = {\n  id: "p-id-0",\n  depth: 1,\n  moreInfo: "I am the parent",\n};\n\nstore.register(elm0D1, ExtraInstanceFunc);\n')),Object(i.b)("h2",{id:"getting-element-in-the-store"},"Getting element in the store"),Object(i.b)("h3",{id:"element-instance-meta-by-id"},"Element Instance Meta by ID"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"store.getElmById(id: string) : Object<elmInstanceMeta>\n")),Object(i.b)("p",null,"It returns ",Object(i.b)("inlineCode",{parentName:"p"},"Object<elmInstanceMeta>")," which contains element metadata including\ngenerated keys and indexes with registered data."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"id: string")," - element id.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"depth: number")," - element depth in DOM tree.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"order: Object <elementOrder>")),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"self: number")," - Element self index among its siblings."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"parent: number")," - Parent index among its siblings."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"keys: Object <relationKey>")),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"sK: string")," - Siblings Key, connects nodes in the same level."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"pK: string")," - Parent key, connects nodes in the higher level."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"chK: string")," - Children Key, connects nodes in the lower level."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"rest: any")," - data already entered when element is registered."))),Object(i.b)("p",null,"Let's apply it on element with ",Object(i.b)("inlineCode",{parentName:"p"},"id= id-0")," which we already registered in the\nstore:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'const elemInstance = store.getElmById("id-0");\n\n// elemInstance = {\n//   depth: 0,\n//   id: "id-0",\n//   keys: {\n//     chK: null,\n//     pK: "1-0",\n//     sK: "0-0",\n//   },\n//   moreInfo: "I am the first child",\n//   order: {\n//     parent: 0,\n//     self: 0,\n//   },\n// };\n')),Object(i.b)("h3",{id:"element-in-tree-by-id"},"Element in Tree by ID"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"store.getElmTreeById(id: string) : Object<elmInstanceConnection>\n")),Object(i.b)("p",null,"It returns ",Object(i.b)("inlineCode",{parentName:"p"},"Object<elmInstanceConnection>")," which contains element connections in DOM tree with\nregistered data. It includes:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"element: Object<elmInstanceMeta>"),"- for targeted element.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"parent: Object<elmInstanceMeta>"),"- for element's parent.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"branches: Object<treeBranches>"),":"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"siblings: string<id>|Array<ids>")," - all element's siblings.")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("inlineCode",{parentName:"p"},"parents: string<id>|Array<ids>")," - all element's parents."))))),Object(i.b)("p",null,"Going back to our first element with ",Object(i.b)("inlineCode",{parentName:"p"},"id= id-0"),", we can get element instance,\nits parent instance, and its connection branches as following:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'const elmInstanceConnection = store.getElmTreeById("id-0");\n\n// elmInstanceConnection = {\n//   element: {\n//     id: "id-0",\n//     depth: 0,\n//     moreInfo: "I am the first child",\n//     order: { self: 0, parent: 0 },\n//     keys: { sK: "0-0", pK: "1-0", chK: null },\n//   },\n//   parent: {\n//     depth: 1,\n//     id: "p-id-0",\n//     keys: {\n//       chK: "0-0",\n//       pK: "2-0",\n//       sK: "1-0",\n//     },\n//     moreInfo: "I am the parent",\n//     order: {\n//       parent: 0,\n//       self: 0,\n//     },\n//   },\n//   branches: { siblings: ["id-0", "id-1"], parents: "p-id-0" },\n// };\n')),Object(i.b)("h2",{id:"why-this-is-matter"},"Why this is matter"),Object(i.b)("p",null,"Because now you can traverse through DOM tree with existing store. Note that\n",Object(i.b)("inlineCode",{parentName:"p"},"elmInstanceConnection.branches.parents")," allows you to go up while\n",Object(i.b)("inlineCode",{parentName:"p"},"elmInstanceConnection.branches.siblings")," allows you to traverse through all\nnode siblings. And not only that, both ways retrieve nodes in order."))}b.isMDXComponent=!0},91:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return u}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),b=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=b(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(n),m=r,u=p["".concat(l,".").concat(m)]||p[m]||d[m]||i;return n?a.a.createElement(u,o(o({ref:t},s),{},{components:n})):a.a.createElement(u,o({ref:t},s))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);